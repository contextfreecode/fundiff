def square (x:n=>Float) : n=>Float =
    pow x (for i. 2.0)

def sum_square(x:n=>Float) : Float =
    -- :p 5
    x2 = square x
    sum x2
    -- sum $ square x

x = linspace (Fin 17) (-4.0) 4.5
:p transpose [x, square x, grad sum_square x]

-- :p calc_grad
-- :p grad sum_square x
-- :p grad (\x. sum $ square x) x
-- :p jvp square x one

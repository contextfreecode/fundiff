def square (x:n=>Float) : n=>Float =
    pow x (for i. 2.0)

def sum_square (x:n=>Float) : Float =
    -- :p 5
    x2 = square x
    sum x2
    -- sum $ square x

def calc_grad (x:n=>Float) : n=>(Fin 3)=>Float =
    transpose [x, square x, grad sum_square x]

x = linspace (Fin 17) (-4.0) 4.5
:p calc_grad x

-- :p calc_grad
-- :p grad sum_square x
-- :p grad (\x. sum $ square x) x
-- :p jvp square x one
